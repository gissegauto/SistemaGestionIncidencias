<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="factura" pageWidth="595" pageHeight="842" columnWidth="535" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="0" uuid="79e370ab-9616-4456-8678-984b7f686569">
	<property name="ireport.zoom" value="1.6105100000000045"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="96"/>
	<style name="Title" fontName="Arial" fontSize="26" isBold="true" pdfFontName="Helvetica-Bold"/>
	<style name="SubTitle" forecolor="#666666" fontName="Arial" fontSize="18"/>
	<style name="Column header" forecolor="#FFFFFF" fontName="Arial" fontSize="12" isBold="true"/>
	<style name="Detail" fontName="Arial" fontSize="12"/>
	<parameter name="id" class="java.lang.Integer">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="SUBREPORT_DIR" class="java.lang.String" isForPrompting="false">
		<defaultValueExpression><![CDATA[""]]></defaultValueExpression>
	</parameter>
	<parameter name="total_Letras" class="java.lang.String"/>
	<queryString>
		<![CDATA[select
presupuesto."presupuesto_id" AS presupuesto_id,
presupuesto."nro_presupuesto" AS presupuesto_nro_presupuesto,
presupuesto."cliente_id" AS presupuesto_cliente_id,
presupuesto."orden" AS presupuesto_orden,
presupuesto."fecha_emision" AS presupuesto_fecha_emision,
extract(year from presupuesto."fecha_emision") as anho,
extract(day from presupuesto."fecha_emision") as dia,
extract(month from presupuesto."fecha_emision") as mes,
presupuesto."fecha_vencimiento" AS presupuesto_fecha_vencimiento,
presupuesto."tipo_presupuesto" AS presupuesto_tipo_factura,
presupuesto."forma_pago" AS presupuesto_forma_pago,
presupuesto."total_letras" AS presupuesto_totalLetras,
presupuesto_detalle."presupuesto_id" AS presupuesto_detalle_factura_id,
presupuesto_detalle."producto_id" AS presupuesto_detalle_producto_id,
presupuesto_detalle."cantidad" AS presupuesto_detalle_catidad,
presupuesto_detalle."sub_total" AS presupuesto_detalle_sub_total,
presupuesto_detalle."total_a_pagar_en_letras",
cliente."nombre" AS cliente_nombre,
cliente."direccion" AS ciente_direccion,
cliente."ruc" AS ciente_ruc,
cliente."dv" as ciente_dv,
producto."descripcion" AS producto_descripcion,
producto."codigo" AS producto_codigo,
producto."precio" AS producto_precio

FROM
"public"."presupuesto" presupuesto
INNER JOIN "public"."presupuesto_detalle" presupuesto_detalle ON presupuesto."presupuesto_id" = presupuesto_detalle."presupuesto_id"
INNER JOIN "public"."cliente" cliente ON presupuesto."cliente_id" = cliente."cliente_id"
LEFT JOIN "public"."producto" producto ON presupuesto_detalle."producto_id" = producto."producto_id"
LEFT JOIN"public"."servicios" servicios ON presupuesto_detalle."servicio_id" = servicios."servicio_id"


WHERE
presupuesto."presupuesto_id" =$P{id}]]>
	</queryString>
	<field name="presupuesto_id" class="java.lang.Integer"/>
	<field name="presupuesto_nro_presupuesto" class="java.lang.String"/>
	<field name="presupuesto_cliente_id" class="java.lang.Integer"/>
	<field name="presupuesto_orden" class="java.lang.Integer"/>
	<field name="presupuesto_fecha_emision" class="java.sql.Date"/>
	<field name="anho" class="java.lang.Double"/>
	<field name="dia" class="java.lang.Double"/>
	<field name="mes" class="java.lang.Double"/>
	<field name="presupuesto_fecha_vencimiento" class="java.sql.Date"/>
	<field name="presupuesto_tipo_factura" class="java.lang.String"/>
	<field name="presupuesto_forma_pago" class="java.lang.String"/>
	<field name="presupuesto_totalletras" class="java.lang.String"/>
	<field name="presupuesto_detalle_factura_id" class="java.lang.Integer"/>
	<field name="presupuesto_detalle_producto_id" class="java.lang.Integer"/>
	<field name="presupuesto_detalle_catidad" class="java.lang.Integer"/>
	<field name="presupuesto_detalle_sub_total" class="java.lang.Double"/>
	<field name="total_a_pagar_en_letras" class="java.lang.String"/>
	<field name="cliente_nombre" class="java.lang.String"/>
	<field name="ciente_direccion" class="java.lang.String"/>
	<field name="ciente_ruc" class="java.lang.String"/>
	<field name="ciente_dv" class="java.math.BigDecimal"/>
	<field name="producto_descripcion" class="java.lang.String"/>
	<field name="producto_codigo" class="java.lang.String"/>
	<field name="producto_precio" class="java.math.BigDecimal"/>
	<variable name="total_pagar" class="java.math.BigDecimal" calculation="Sum"/>
	<variable name="total" class="java.lang.Integer">
		<variableExpression><![CDATA[$V{total}]]></variableExpression>
	</variable>
	<variable name="iva_final_5" class="java.lang.String">
		<variableExpression><![CDATA[]]></variableExpression>
	</variable>
	<variable name="iva_final_10" class="java.lang.String">
		<variableExpression><![CDATA[]]></variableExpression>
	</variable>
	<variable name="producto_precio_1" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{producto_precio}]]></variableExpression>
	</variable>
	<variable name="producto_precio_2" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{producto_precio}]]></variableExpression>
	</variable>
	<variable name="presupuesto_detalle_sub_total_1" class="java.lang.Double" calculation="Sum">
		<variableExpression><![CDATA[$F{presupuesto_detalle_sub_total}]]></variableExpression>
	</variable>
	<title>
		<band height="67" splitType="Stretch">
			<image>
				<reportElement x="2" y="0" width="195" height="57" uuid="1c97d518-799b-4b37-9e71-147764af54e8"/>
			</image>
		</band>
	</title>
	<pageHeader>
		<band splitType="Stretch"/>
	</pageHeader>
	<columnHeader>
		<band height="100" splitType="Stretch">
			<textField pattern="###0">
				<reportElement x="45" y="35" width="35" height="14" uuid="992f489a-11db-4913-b577-323126dbb099"/>
				<textFieldExpression><![CDATA[$F{dia}]]></textFieldExpression>
			</textField>
			<textField pattern="###0">
				<reportElement x="139" y="35" width="58" height="14" uuid="d2601776-ad36-4332-b24b-60d3e30b15ad"/>
				<textFieldExpression><![CDATA[$F{mes}]]></textFieldExpression>
			</textField>
			<textField pattern="###0">
				<reportElement x="288" y="35" width="59" height="14" uuid="ac276a87-a912-4e2d-a08e-e39e589cfe00"/>
				<textFieldExpression><![CDATA[$F{anho}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="440" y="35" width="10" height="14" uuid="94454680-d22b-405d-bf6b-2da35a839a5b"/>
				<textFieldExpression><![CDATA[(null != $F{presupuesto_forma_pago} && !$F{presupuesto_forma_pago}.equals("EF"))?"X":""]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="489" y="35" width="13" height="14" uuid="255f635f-d78b-4661-bf8f-1482bfca8c73"/>
				<textFieldExpression><![CDATA[(null != $F{presupuesto_forma_pago} && !$F{presupuesto_forma_pago}.equals("CQ"))?"X":""]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="45" y="60" width="175" height="13" uuid="3390574a-5c15-4b4e-8a36-a25e0136f0b7"/>
				<textFieldExpression><![CDATA[$F{cliente_nombre}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="56" y="82" width="175" height="13" uuid="6123274b-adfb-459b-9c24-e84932bf91f6"/>
				<textFieldExpression><![CDATA[$F{ciente_direccion}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="360" y="82" width="100" height="13" uuid="6c9b1172-4c53-4db5-b40f-acc7cb7ba41c"/>
				<textFieldExpression><![CDATA[$F{ciente_ruc}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="462" y="82" width="29" height="13" uuid="960e61ce-91f1-4ea4-9866-a9a031a135d5"/>
				<textFieldExpression><![CDATA[$F{ciente_dv}]]></textFieldExpression>
			</textField>
		</band>
	</columnHeader>
	<columnFooter>
		<band splitType="Stretch"/>
	</columnFooter>
	<summary>
		<band height="352">
			<textField>
				<reportElement x="323" y="274" width="41" height="20" uuid="9266fa3f-a248-4816-80df-dc90bbe50f74"/>
				<textFieldExpression><![CDATA[$V{producto_precio_2}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="389" y="274" width="100" height="20" uuid="6a93575a-da61-4604-b6ea-2f48f372d1c9"/>
				<textFieldExpression><![CDATA[$V{presupuesto_detalle_sub_total_1}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="125" y="297" width="335" height="16" uuid="e1987618-46bb-4ef2-af55-10a199307928"/>
				<textFieldExpression><![CDATA[$P{total_Letras}==null?"":$P{total_Letras}.toString()]]></textFieldExpression>
			</textField>
			<subreport>
				<reportElement x="12" y="91" width="523" height="40" uuid="8d729132-5832-4ef1-bf55-c0279a0c674b"/>
				<subreportParameter name="id_factura"/>
				<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
				<subreportExpression><![CDATA[$P{SUBREPORT_DIR} + "presupuesto_detalle.jasper"]]></subreportExpression>
			</subreport>
		</band>
	</summary>
</jasperReport>
