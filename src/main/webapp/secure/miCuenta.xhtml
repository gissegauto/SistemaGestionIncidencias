<?xml version="1.0" encoding="UTF-8"?>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui">

    <h:body>
        <ui:composition template="/template/base.xhtml">
            <ui:define name="content">
                <p:fieldset title="#{msg['micuenta.datos']}" style="margin-bottom:5px; font-size:15px " >
                    <h:form id="miCuentaForm">
                        <p:growl id="growl"  autoUpdate="true" showDetail="true" sticky="true" />
                        <div align="center">
                            <p:outputLabel value="#{msg['micuenta.title']} " class="card-title" style="color: #0056b3; font-size:18px; font-weight: bold"/>
                        </div>
                        <p:fieldset style="margin-bottom:5px; font-size:15px " >
                            <p:fieldset style="margin-bottom:5px; font-size:15px; border-radius: 10px " >
                                <h:panelGrid  columns="2">
                                    <h6 style="color: #0056b3; font-weight: bold">#{msg['micuenta.datos.usuario']}</h6>
                                    <p:commandButton icon="fa fa-pencil" 
                                                     value="#{msg['micuenta.actualizar.pass']}"
                                                     title="#{msg['micuenta.actualizar.pass']}"
                                                     update=":form-actualizar-pass:actualizarPassGr" 
                                                     oncomplete="PF('dlgActualizarPass').show()" 
                                                     style="margin-left: 70%"
                                                     />
                                </h:panelGrid>
                                <p:separator/>
                                <p:outputPanel id="miCuentaDetail" class="col-sm-12">
                                    <h:panelGrid  columns="2" rendered="#{not empty miCuentaBean.usuario}" columnClasses="label,value">
                                        <p:outputLabel value="#{msg['micuenta.username']}"  style="font-weight: bold" id="username"/>
                                        <h:outputText value="#{miCuentaBean.usuario.username}" class="col-sm-4"/>
                                        <p:outputLabel value="#{msg['micuenta.rol']}"  style="font-weight: bold" />
                                        <h:outputText value="Administrador" rendered="#{miCuentaBean.usuario.idrol.descripcion == 'Admin'}" class="col-sm-4"/>
                                        <h:outputText value="#{miCuentaBean.usuario.idrol.descripcion}" rendered="#{miCuentaBean.usuario.idrol.descripcion != 'Admin'}" class="col-sm-4"/>
                                    </h:panelGrid>
                                </p:outputPanel>
                            </p:fieldset>
                            <br />
                            <p:fieldset id="datosPersonales" class="col-sm-12" style="margin-bottom:5px; font-size:15px; border-radius: 10px " >
                                <h:panelGrid  columns="2">
                                    <h6 style="color: #0056b3; font-weight: bold">Datos Personales</h6>
                                    <p:commandButton icon="fa fa-pencil" 
                                                     value="#{msg['micuenta.actualizar']}"
                                                     title="#{msg['micuenta.actualizar']}"
                                                     update=":form-actualizar-datos:actualizarDatosGr" 
                                                     oncomplete="PF('dlgActualizarDatos').show()" 
                                                     style="margin-left: 75%"
                                                     />
                                </h:panelGrid>
                                <p:separator/>
                                <p:outputPanel id="miCuentaDatosDetail">
                                    <h:panelGrid  columns="4" rendered="#{not empty miCuentaBean.usuario}" columnClasses="label,value">
                                        <p:outputLabel value="#{msg['funcionario.add.nombre']}" style="font-weight: bold"/>
                                        <h:outputText value="#{miCuentaBean.usuario.idFuncionario.nombreFuncionario}" style="margin-left: 1px" />

                                        <p:outputLabel value="#{msg['funcionario.add.apellido']}" style=" font-weight: bold"/>
                                        <h:outputText value="#{miCuentaBean.usuario.idFuncionario.apellidoFuncionario}" style="margin-left: 3px"/>

                                        <p:outputLabel value="#{msg['funcionario.add.nroDocumento']}" style="font-weight: bold"/>
                                        <h:outputText value="#{miCuentaBean.usuario.idFuncionario.nroDocumento}" style="margin-left:  3px" />

                                        <p:outputLabel value="#{msg['funcionario.add.celular']}" style="font-weight: bold"/>
                                        <h:outputText value="#{miCuentaBean.usuario.idFuncionario.celular}" style="margin-left: 3px" />

                                        <p:outputLabel value="#{msg['funcionario.add.ciudad']}" style="font-weight: bold"/>
                                        <h:outputText value="#{miCuentaBean.usuario.idFuncionario.idBarrio.idCiudad.ciudad}" style="margin-left: 3px" />

                                        <p:outputLabel value="#{msg['funcionario.add.telefono']}" style=" font-weight: bold"/>
                                        <h:outputText value="#{miCuentaBean.usuario.idFuncionario.telefono}" style="margin-left:  3px" />

                                        <p:outputLabel value="#{msg['funcionario.add.estado']}"  style="font-weight: bold"/>
                                        <h:outputText value="#{miCuentaBean.usuario.idFuncionario.estado}" style="margin-left: 3px" />

                                        <p:outputLabel value="#{msg['funcionario.add.barrio']}" style="font-weight: bold"/>
                                        <h:outputText value="#{miCuentaBean.usuario.idFuncionario.idBarrio.barrio}" />
                                    </h:panelGrid>
                                    <h:panelGrid columns="3" >
                                        <p:outputLabel value="#{msg['funcionario.add.direccion']}" style="font-weight: bold"/>
                                        <h:outputText value="#{miCuentaBean.usuario.idFuncionario.direccion}"  />
                                    </h:panelGrid> 
                                </p:outputPanel>
                            </p:fieldset>
                            <br />
                            <p:fieldset style="margin-bottom:5px; font-size:15px; border-radius: 10px " >
                                <h6 style="color: #0056b3; font-weight: bold">Auditoria</h6>
                                <p:separator/>
                                <h:panelGrid  columns="4" rendered="#{not empty miCuentaBean.usuario}" columnClasses="label,value">
                                    <p:outputLabel value="#{msg['generic.fechaR']}" style="font-weight: bold"/>
                                    <h:outputText value="#{miCuentaBean.usuario.idFuncionario.fechaRegistro}" style="margin-left: 45%" >
                                        <f:convertDateTime pattern="dd-MM-yyyy" />
                                    </h:outputText>
                                    <p:outputLabel value="#{msg['generic.fechaA']}" style="font-weight: bold"/>
                                    <h:outputText value="#{miCuentaBean.usuario.idFuncionario.fechaActualizacion}" style="margin-left: 45%">
                                        <f:convertDateTime pattern="dd-MM-yyyy" />
                                    </h:outputText>
                                </h:panelGrid>    
                            </p:fieldset>
                        </p:fieldset>
                    </h:form> 
                    <p:dialog header="#{msg['micuenta.actualizar.pass']}" widgetVar="dlgActualizarPass"
                              modal="true" showEffect="fade" hideEffect="fade" resizable="true">
                        <p:fieldset  style="margin-bottom:5px; font-size:12px " >
                            <h:form id="form-actualizar-pass" >
                                <p:growl id="growl" autoUpdate="true" showDetail="true" sticky="true" />
                                <h:panelGrid id="actualizarPassGr" columns="2" columnClasses="column" >
                                    <p:outputLabel value="#{msg['micuenta.password']}" style="right: 10%; font-weight: bold"/>
                                    <p:password id="password" value="#{miCuentaBean.password}" feedback="true" 
                                                promptLabel="Por favor ingrese su contraseña"
                                                maxlength="45" requiredMessage="Ingrese Password" required="true"/>
                                    <p:outputLabel value="#{msg['micuenta.password.nuevo']}" style="right: 10%; font-weight: bold"/>
                                    <p:password id="nuevo" value="#{miCuentaBean.nuevo}" feedback="true" 
                                                promptLabel="Por favor ingrese una nueva contraseña"
                                                weakLabel="Débil"
                                                goodLabel="Bueno" strongLabel="Seguro"
                                                maxlength="45" requiredMessage="Ingrese Password" required="true"/>
                                    <p:outputLabel value="#{msg['micuenta.password.repetir']}" style="right: 10%; font-weight: bold"/>
                                    <p:password id="repetir" value="#{miCuentaBean.repetir}" feedback="true" 
                                                promptLabel="Por favor repita su contraseña"
                                                weakLabel="Débil"
                                                goodLabel="Bueno" strongLabel="Seguro"
                                                maxlength="45" requiredMessage="Ingrese Password" required="true"/>
                                </h:panelGrid>
                                <br />
                                <div style="text-align:center;" >
                                    <p:commandButton 
                                        value="#{msg['generic.actualizar']}" 
                                        id='btn-guardar-miCuenta' 
                                        action="#{miCuentaBean.actualizarPass}"/>
                                </div>
                            </h:form>
                        </p:fieldset>
                    </p:dialog>
                    <p:dialog header="#{msg['micuenta.actualizar.datos']}" widgetVar="dlgActualizarDatos"
                              modal="true" showEffect="fade" hideEffect="fade" resizable="true">
                        <p:fieldset  style="margin-bottom:5px; font-size:12px " >
                            <h:form id="form-actualizar-datos" >
                                <p:growl id="growl" autoUpdate="true" showDetail="true" sticky="true" />
                                <h:panelGrid id="actualizarDatosGr" columns="3" columnClasses="column" >
                                    <p:outputLabel value="#{msg['funcionario.nombre']}" for="nombre" style="left:  20%"/>
                                    <p:inputText id="nombre" required="true" requiredMessage="#{msg['requerid.nombre']}"
                                                 value="#{miCuentaBean.funcionario.nombreFuncionario}" />
                                    <p:spacer/>
                                    <p:outputLabel value="#{msg['funcionario.add.apellido']}" for="apellido" style="right: 20%"/>
                                    <p:inputText id="apellido" required="true" requiredMessage="#{msg['requerid.apellido']}"
                                                 value="#{miCuentaBean.funcionario.apellidoFuncionario}" />
                                    <p:spacer/>
                                    <p:outputLabel value="#{msg['funcionario.add.direccion']}" for="direccion" style="right: 20%"/>
                                    <p:inputText id="direccion" required="true" requiredMessage="#{msg['requerid.direccion']}"
                                                 value="#{miCuentaBean.funcionario.direccion}" />
                                    <p:spacer/>
                                    <p:outputLabel value="#{msg['funcionario.add.telefono']}" for="telefono" style="right: 20%"/>
                                    <p:inputText id="telefono" 
                                                 value="#{miCuentaBean.funcionario.telefono}" />
                                    <p:spacer/>
                                    <p:outputLabel value="#{msg['funcionario.add.celular']}" for="celular" style="right: 20%"/>
                                    <p:inputMask id="celular" mask="(9999) 999-999"
                                                 value="#{miCuentaBean.funcionario.celular}" />
                                    <p:spacer/>
                                    <p:outputLabel value="#{msg['funcionario.add.tipoDocumento']}" for="tipoDocumento"  />
                                    <p:selectOneMenu id="tipoDocumento" value="#{miCuentaBean.funcionario.tipoDocumento}" style="width:125px">
                                        <f:selectItem itemLabel="CI" itemValue="CI" />
                                        <f:selectItem itemLabel="RUC" itemValue="RUC" />
                                        <f:selectItem itemLabel="DNI" itemValue="DNI" />
                                    </p:selectOneMenu>
                                    <p:spacer/>
                                    <p:outputLabel value="#{msg['funcionario.add.nroDocumento']}" for="nroDocumento" style="right: 20%"/>
                                    <p:inputText id="nroDocumento" 
                                                 value="#{miCuentaBean.funcionario.nroDocumento}" />
                                    <p:spacer/>
                                    <p:outputLabel value="#{msg['funcionario.add.ciudad']}" for="ciudad" />
                                    <p:selectOneMenu id="ciudad" value="#{miCuentaBean.ciudad}" 
                                                     effect="fold" editable="false"
                                                     validatorMessage="Debe seleccionar una ciudad"
                                                     filter="true" filterMatchMode="startsWith"
                                                     converter="ciudadConverter" >
                                        <f:selectItems value="#{miCuentaBean.ciudadList}" 
                                                       var="ciudad" itemLabel="#{ciudad.ciudad}" 
                                                       itemValue="#{ciudad}" />
                                        <p:ajax  process="ciudad"  event="change"
                                                 update=":form-actualizar-datos:barrio"
                                                 listener="#{miCuentaBean.buscarBarrios}"/> 
                                    </p:selectOneMenu>                                                             
                                    <p:spacer/>     
                                    <p:outputLabel value="#{msg['funcionario.add.barrio']}" for="barrio" />
                                    <p:selectOneMenu id="barrio" value="#{miCuentaBean.barrio.idBarrio}" 
                                                     effect="fold" editable="false" 
                                                     filter="true" filterMatchMode="startsWith"
                                                     converter="barrioConverter" >
                                        <f:selectItems value="#{miCuentaBean.barrioList}" 
                                                       var="barrio" itemLabel="#{barrio.barrio}" 
                                                       itemValue="#{barrio}"/>
                                    </p:selectOneMenu>
                                    <p:spacer/>
                                </h:panelGrid>
                                <br />
                                <div style="text-align:center;" >
                                    <p:commandButton 
                                        value="#{msg['generic.actualizar']}" 
                                        id='btn-guardar-datos' 
                                        action="#{miCuentaBean.actualizarDatos}"/>
                                </div>
                            </h:form>
                        </p:fieldset>
                    </p:dialog>
                </p:fieldset>
            </ui:define>
        </ui:composition>
    </h:body>
</html>
